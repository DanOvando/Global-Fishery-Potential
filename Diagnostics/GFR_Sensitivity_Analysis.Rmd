---
title: "GFR SOM Sensitivities"
author: "Dan Ovando"
date: "February 26, 2015"
output:
  pdf_document:
    fig_caption: yes
    fig_height: 3
    fig_width: 6
  word_document:
    fig_caption: yes
    fig_height: 6
    fig_width: 8
---


# Model Validation

We performed a series of jackknifing and Monte Carlo routines to evaluate the performance of our models across a variety of metrics including

* The effects of Illegal, unreported, unregulated fishing (IUU)
* Out of sample prediction of B/B~MSY~, F/F~MSY~, and MSY
* Sensitivity of our predicted future values to uncertainty in
  * MSY
  * Profits
  * Catch
  * B/B~MSY~
  * F/F~MSY~

## Key Results

* IUU has little effect on estimated B/B~MSY~ and F/F~MSY~, but has an almost perfectly linear effect on MSY; if catch is in fact 25% higher than reported, MSY rises by 25%
* Out estimates of MSY are likely to be conservative if chronic under-reporting of catch is occurring
* Our estimates of B/B~MSY~ are likely on negatively biased on average
* The magnitude of catch in any given year has no systemic effect on estimated B/B~MSY~
* We overestimate B/B~MSY when the stock is very depleted. and under-estimate B/B~MSY~ when the stock is relatively unexploited
* We systemically overestimate F/F~MSY~, and our estimates themselves are highly uncertain
* The jackknifing routines strongly suggest that we are underestimating MSY both at the individual fishery and regional level
* Our estimates of total MSY and catch are relatively insensitive to uncertainty in price, costs, growth rates, and carrying capacity
* Our estimates of total profits are much more sensitive to uncertainty in price, costs, growth rates, and carrying capacity. 


## IUU

Stock assessed fisheries make up a substantial portion of the catch and global MSY in our analysis. However, XX% of fisheries, XX% of catch, and XX% of MSY in our analysis are derived from unassessed fisheries, through our paired PRM-Catch-MSY process. Both the PRM and Catch-MSY depend on the reported catch history in order to reach results; while life history variables are included the catch is the basis of the method. The quality of catch records for these unassessed fisheries is highly variable, and in many instances misreporting occurs. This may take the form of IUU fishing, which would mean that more catch is occurring than is being reported, over-reporting of catches (as occurred with Chinese catches), or random misreporting. Given the recent focus on the problem of IUU, we tested the robustness of our estimates of B/B~MSY~ F/F~MSY~, and MSY to the presence of IUU. 

We increased the catches of each unassessed stock by 25%. We then re-estimated B/B~MSY~ using the PRM with the new IUU adjusted catch. Note that raw catch only enters the PRM through the max catch variables; if we assume a constant rate of IUU then all other catch statistics in the PRM remain the same, as they are all scaled relative to max catch. The IUU based estimates of B/B~MSY~ were then fed to Catch-MSY as the priors on final depletion, and MSY, F/F~MSY~,B/B~MSY~, and *g* were estimated. These metrics resulting from the IUU adjusted catch were then compared to the original values estimated with the raw reported catch data. 

Our results indicate that on average an IUU level of 25% has on average no effect on our estimates B/B~MSY~ and F/F~FMSY~ (Fig.XX). Our estimate of total MSY is on average highly linearly related with IUU; when catches were increased by 25%, most fishery's MSY also increased by 25%, though some fisheries saw a greater increase in MSY. Our results indicate that if IUU, in the form of systemic under-reporting of catch, is present, our methods are likely to underestimate MSY. This suggests that if under-reporting of global catch is occurring, our estimates of MSY are conservative. 

![Effects of IUU. Proportional error represents the % change from the current estimate of B/B~MSY~ (bPE), F/F~MSY~(fPE), and MSY (MSYPE). The black vertical line marks a proportional error of zero. The red line is the percentage of IUU used](IUU_Effect.pdf)


## Individual Jackknife

We performed two jackknife routines to evaluate the ability of our model to predict out of sample. For both routines, we consider only RAM stocks, as these are the only instances we have "true" values for the parameters of interest (MSY, B/B~MSY~, F/F~MSY~). 

We first performed an individual jackknife. We sequentially removed each RAM stock (n=398) from the regression block and re-estimated the PRM. We then predicted the status of the omitted stock using the re-estimated regression.  This predicted status was passed to Catch-MSY as the prior on final depletion, and the resulting predictions for B/B~MSY~, F/F~MSY~, and MSY for the omitted RAM stock were stored. 

Our median proportional error in B/B~MSY~ in 2012 (the primary year of interest) was  ~20%, suggesting that for the median fishery we are underestimating B/B~MSY~.  However, there is substantial variation in our estimates (Fig.XX). The individual jackknifing suggest that our estimates are on average negatively biased, but that there is substantial variation in the direction and magnitude of this bias for any individual fishery. 


```{r,echo=F,message=F,warning=FALSE,fig.cap='Proportional error in B/B~MSY~ over time'}

setwd('/Users/danovando/Desktop/Bren/SFG Work/Global Fisheries Recovery/')

library(ggplot2)

BatchFolder<- "Results/4.2/"

FigureFolder<- paste(BatchFolder,'Diagnostics/Individual Jackknife/',sep='')

Plots<- load(paste(FigureFolder,'Jacknife Plots.rdata',sep=''))

B_Error_By_Time
  
# save(B_Error_Time_Country,F_Error_Time_Country,MSY_Error_By_LogCatch,
#        B_Error_By_RamB,B_Error_By_Time,F_Error_By_Time,MSY_Error_By_Country,file=paste(FigureFolder,'Jacknife Plots.rdata',sep=''))
```

The proportional error in our estimates of B/B~MSY~ appear uncorrelated with catch in any given year (Fig.XX), but highly influenced by the true B/B~MSY~ (Fig.XX). Specifically, we severely over-predict the B/B~MSY~ for highly overfished RAM stocks (i.e. when "true" B/B~MSY~ is less than 0.5, Fig.XX), and under-predict B/B~MSY~ when true B/B~MSY~ is high. 

```{r,echo=F,message=FALSE,warning=FALSE,dpi=200,fig.cap='Proportional error in B/B~MSY~ by catch' }

B_Error_By_LogCatch

```


```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Proportional error in B/B~MSY~ by RAM B/B~MSY~' }

B_Error_By_RamB

```

The F/F~MSY~ values from our individual jackknifing are highly positively biased, and have substantial amounts of error (Fig.XX)

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Proportional error in F/F~MSY~ over time' }

F_Error_By_Time

```

The MSYs estimated through our individual jackknifing routine indicate that we are underestimating MSY out of sample, with a mean underestimate of 50% (Fig.XX). 

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Proportional error in MSY' }

MSY_Error
```

However, there appears to be little correlation between our error in MSY and the size of the fishery (as defined by lifetime catch), indicating that out of sample we underestimate MSY our of sample for most of the RAM stocks regardless of size (Fig.XX)

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Proportional error in MSY by lifetime catch' }

MSY_Error_By_LogCatch

```

## Regional Jackknife

```{r,echo=F,message=FALSE,warning=FALSE}

setwd('/Users/danovando/Desktop/Bren/SFG Work/Global Fisheries Recovery/')

BatchFolder<- "Results/4.2/"

FigureFolder<- paste(BatchFolder,'Diagnostics/Regional Jackknife/',sep='')

Plots<- load(paste(FigureFolder,'Jacknife Plots.rdata',sep=''))

```

We might expect the out-of-sample predictive ability of our model to be fairly good when simply omitting and predicting one single fishery. This paper's results depend though on the ability of our model to predict fisheries that are very much out of sample; we are trying to predict Indonesia using Alaska. As such, we also performed a regional jackknifing routine. In this procedure, we sequentially removed all the RAM stocks in each unique region (roughly country) in RAM. We then re-estimated the PRM omitting all of the RAM stocks from that region, and then predicted the omitted region. The predictions were then passed to Catch-MSY, and the individual predictions for MSY, B/B~MSY~, and F/F~MSY~ for each omitted fishery are stored. Our broad results on the out-of-sample error in B/B~MSY~ F/F~MSY~ and MSY did not substantially change from the individual jackknifing, as such we will focus on the out of sample regional predictive power demonstrated by this analysis. 

Looking at B/B~MSY~, our out-of-sample prediction of B/B~MSY~ varies substantially by region. Australian B/B~MSY~s are severely over-predicted when omitted from the regression, and we systemically underestimate the status of New Zealand and South African stocks under the regional jackknifing. 

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Proportional error in B/B~MSY~ by time and region' }

B_Error_Time_Country
```

The regional out of sample predictive power of MSY shows a negative bias across all regions, providing further evidence that we are likely to be underestimating MSY for most countries. 

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Proportional error in MSY by region' }
MSY_Error_By_Country
```

## Monte Carlo Analysis 

We performed a Monte Carlo routine to evaluate the sensitivity of components of our final results (e.g. total MSY, change in profits, change in B/B~MSY~, etc.). We do not consider potential errors in the underlying catch data, or a complete range of potential starting biomass levels. We do consider the sensitivity of our results in response to limited ranges of starting B/B~MSY~,as well as estimated intrinsic growth rate *g*, MSY, prices, costs, and RBFM economic benefits. 

The Monte Carlo currently only evaluates stocks that were run through Catch-MSY. It does not include RAM stocks for which we have "true" estimates of MSY, since at this time we do not have any method for estimating uncertainty around RAM values. The Monte Carlo also omits NEI stocks at this time.  As a result this process provides an assessment of the broad degree of variability in our metrics of interest resulting from reasonably uncertainty in our parameter values. It is not a true assessment of the actual variability in our final results. 

Catch-MSY provides a range of plausible values for *g* and MSY (often thousands of individual estimates for each fishery). For each iteration of the Monte Carlo, we drew random *g* and MSY pairs from Catch-MSY for each fishery.  For each fishery in each iteration we also apply a multiplicative  log-normal error term (~ln(0,0.25)) to price, B/B~MSY~ at open access (which implicitly affects costs), and the "RBFM effect" (the price and cost changes resulting from moving to an RBFM policy). We ran 500 Monte Carlo iterations for each fishery and stored results. 

Our results show that the total MSY estimated by Catch-MSY has relatively little variability, with most estimates of total MSY falling between 27 and 29 million MT ( Fig.XX ). 

```{r,echo=F,message=FALSE,warning=FALSE}

setwd('/Users/danovando/Desktop/Bren/SFG Work/Global Fisheries Recovery/')

BatchFolder<- "Results/4.2/"

FigureFolder<- paste(BatchFolder,'Diagnostics/Monte Carlo/',sep='')

load(paste(FigureFolder,'MonteCarlo Plots.rdata',sep=''))

FigureFolder<- paste(BatchFolder,'Diagnostics/Monte Carlo 2/',sep='')

load(paste(FigureFolder,'BioMontePlots.Rdata',sep=''))

```

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Distribution of MSY' }
MCMSY
```

Our estimates of total catch in 2050 vary greatly among policies (as they are intended to do), but show relatively little variation within policy (Fig.XX). The BAU policies in particular resulted in  consistently lower catchs than the other policies in all simulations. 

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Distribution of Catch' }
MCCatch
```

Our 2050 distributions of profits by policy do exhibit substantial variability, though the ranking of profitabliity among the scenarios remained realtively constant. Profits under our BAU S1 policy varied drastically as a function of the uncertainty introduced by the Monte Carlo, due to the presence of open-access fleet dynamics. Both F~MSY~ and RBFM policies had higher profits under nearly all iterations, and RBFM was always the most profitable. However, the magnitude of these profits varied substantially among iterations, by over 10 billion dollars in some instances.  This suggests that the relative rankings of our policies, with respesct to future profits, are stable, but our estimates of total future profits (and NPV) themselves are much more uncertain than our estimates of future catch. This comes as no surprise, since our estimates of profits are dependent on more uncertain variables than catches alone. 

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Distribution of Profits' }
MCProfits
```

Our estimates of future B/B~MSY~ (Fig.xx) and F/F~MSY~ (Fig.XX) show very little variation within policies, and the relative differences among policies remain constant. However, this is of little surprise since most of our policies dictate F/F~MSY~ in order to achieve a particular B/B~MSY~. We do not re-optimize our policy functions for each Monte-Carlo run, so we do observe some variation in final B/B~MSY~ stemming from variation in *g*. The net result though is that our estimates of future B/B~MSY~ are largely unaffected by the values of the variables tested in the Monte Carlo. However, it is important to note that we do not consider any stochasticity the population dynamics (such as recruitment shocks), or any explicit errors in the application of management. 

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Distribution of B/B~MSY~' }
MCBvB
```

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Distribution of F/F~MSY~' }
MCFvF
```

## Expanded Monte Carlo

Our Monte Carlo analysis of our unassessed stocks provides an indicator of the variability of our results derived from the uncertianty resulting from Catch-MSY and reasonable uncertainty bounds in other critical parameters. However it does not directly reflect the potential uncertainty in the results reported in the body of the paper, since it does not include RAM, SOFIA, or NEI stocks. In order to address this, we performed an additional Monte Carlo routine, in which arbitraty amounts of error were applied to key parameters of all stocks included in our analysis in order to evaluate the effect of this uncertainty on the some of th key values reported in the body of the paper. 

B/B~MSY~ and F/F~MSY~ in 2012 are uncertain parameters in all of our fisheries. However, we do not have representative bounds on the uncertainty in these estiamtes for all stocks. As such, over our Monte Carlo we introduced an individual random multiplicative error term to B/B~MSY~ of each stock in 2012 (distributed uniform (0.5,1.5), and adjust F/F~MSY~ accordingly by $\frac{F}{F_{MSY}}= \frac{Catch}{MSY*B_{MSY}}$. We then also applied a random multiplicative log-normal error term (mean 0, sd 0.25) to our estimates of MSY, g, price, and B/B~MSY~ at open access (effectively costs) to each stock. Together these terms represent primary drivers of our estimates of current and future profits, yields, and biomass. We projected each stock forward for each policy in the same manner as described in the paper, producing a distribution around our projections of current and future profits, yields, and biomass. 

Our results show that while the point estimates of the total outcomes of any individual policy are variable, the general magnitude of each of the policies, and their performance relative to each other, does not change substantially as a result of introducing significant uncertainty into our model (Fig.XX). So, even if our estimates of status in 2012 are substantially wrong, this has relatively little impact in the findings of our paper. However, our results are more sensitive to our estiamtes of MSY, *g*, price, and BOA. It is important to note that for any given policy each of the points in Fig.XX shares a draw from the same iteration of the Monte Carlo routine with a point in the other policies. As such, while it may appear for example that in some instances the RBFM (CC) policy produced higher profits than the RBFM scenario, each point was not truly independely estimated for each policy, and so this is not a reliable comparison. Rather, the cloud for any given policy provides an estiamte of the uncertainty around that particular policy, but is not as informative as to the ranking of that policy relative to other policies. 

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Monte Carlo of Figure 3' }
BioMontePlot
```

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Ranking of policies by profits in 2050 across iterations' }
BioRanking
```

```{r,echo=F,message=FALSE,warning=FALSE,fig.cap='Ranking of policies by biomass in 2050 across iterations' }
ProfitRanking
```